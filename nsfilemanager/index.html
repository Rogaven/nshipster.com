<!doctype html>
<html lang="en-US">
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
  
    <title>NSFileManager - NSHipster</title>
    <meta name="description" content="File systems are a complex topic, with decades of history, vestigial complexities, and idiosyncrasies, and is well outside the scope of a single article. And since most applications don't often interact with the file system much beyond simple file operations, one can get away with only knowing the basics."/>
    <link rel="canonical" href="http://nshipster.com/nsfilemanager/"/>
  
  
  
  
  <meta name="author" content="Mattt Thompson"/>
  
  <meta name="revisit-after" content="7 days"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"/>
  <link rel="alternate" type="application/rss+xml" title="RSS" href="http://nshipster.com/feed.xml"/>
  <link rel="stylesheet" type="text/css" href="http://nshipster.com/css/screen.css"/>
  <link rel="apple-touch-icon" href="/touch-icon-iphone.png"/>
  <link rel="apple-touch-icon" sizes="76x76" href="/touch-icon-ipad.png"/>
  <link rel="apple-touch-icon" sizes="120x120" href="/touch-icon-iphone-retina.png"/>
  <link rel="apple-touch-icon" sizes="152x152" href="/touch-icon-ipad-retina.png"/>
  <link rel="icon" sizes="16x16 24x24 32x32 48x48 64x64" type="image/vnd.microsoft.icon" href="/favicon.ico"/>
  <link rel="mask-icon" sizes="any" href="/website_icon.svg" color="black"/>
  <link rel="author" type="text/plain" href="http://nshipster.com/humans.txt"/>

  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:site" content="@NSHipster"/>
  
  <meta name="twitter:creator" content="@mattt"/>
  
  
    <meta name="twitter:title" content="NSFileManager"/>
    <meta name="twitter:description" content="File systems are a complex topic, with decades of history, vestigial complexities, and idiosyncrasies, and is well outside the scope of a single article. And since most applications don&#39;t often interact with the file system much beyond simple file operations, one can get away with only knowing the basics."/>
  
  <meta property="twitter:account_id" content="629523445"/>

  <meta property="og:site_name" content="NSHipster"/>
  <meta property="og:image" content="http://nshipster.com/touch-icon-ipad-retina.png"/>
  
    <meta property="og:type" content="article"/>
    <meta property="og:title" content="NSFileManager"/>
    <meta property="og:url" content="http://nshipster.com/nsfilemanager/"/>
    <meta property="og:description" content="File systems are a complex topic, with decades of history, vestigial complexities, and idiosyncrasies, and is well outside the scope of a single article. And since most applications don&#39;t often interact with the file system much beyond simple file operations, one can get away with only knowing the basics."/>
    <meta property="article:published_time" content="2013-11-18T00:00:00-08:00"/>
    <meta property="article:modified_time" content="2015-12-09T21:06:40-08:00"/>
    <meta property="article:tag" content="cocoa"/>
    <meta property="article:publisher" content="https://www.facebook.com/NSHipster">
  

  
    <meta property="st:title" content="NSFileManager"/>
    <meta property="st:type" content="article"/>
  
  
  <meta property="nshipster:hide-single-lang" content="swift,objective-c"/>
</head>

<body itemscope itemtype="http://schema.org/WebPage">

  <script src="http://nshipster.com/js/zepto.min.js"></script>
  <script src="http://nshipster.com/js/application.js"></script>

  <div role="container">
    <header role="banner">
      <h1 id="logo">
        <a href="/">
          <svg id="ns" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
   viewBox="0 0 79.5 45.7" enable-background="new 0 0 79.5 45.7" xml:space="preserve">
<g>
  <path fill="#F58020" d="M0.6,1h13.7L27,24.4h0.1V1h12.7v43.6H26.8L13.4,20.8h-0.1v23.8H0.6V1z"/>
  <path fill="#F58020" d="M51.4,30c0,1.1,0.2,2.1,0.5,2.9c1,2.6,3.9,3.2,6.4,3.2c2.2,0,5.6-0.7,5.6-4c0-2.3-1.9-2.9-9.4-5
    c-6.9-2-14.8-3.8-14.8-12.6C39.7,4.3,48.3,0,57.3,0c9.5,0,17.8,3.6,18.2,14.2H62.8c0.2-1.6-0.5-2.7-1.6-3.5
    c-1.1-0.8-2.6-1.1-4-1.1c-1.8,0-4.8,0.5-4.8,2.9c0.2,3.1,6.5,3.8,12.6,5.5c6.2,1.7,12.3,4.6,12.3,12.6c0,11.4-10.4,15-20.1,15
    c-4.9,0-19-1.8-19.2-15.7H51.4z"/>
</g>
</svg>

          <svg id="mustache" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
   viewBox="0 0 79.5 45.7" enable-background="new 0 0 79.5 45.7" xml:space="preserve">
  <g transform="translate(0,-952.36217)" opacity="0.95">
    <path id="path2987" fill="#010101" d="M28.2,971.4c-10,0.5-19.1,13.3-28.2,2.1c0,15.1,23.7,30.5,39.8,16.3
      c16,14.1,39.8-1.3,39.8-16.3c-12.5,15.4-25-14.4-39.8,4.5C35.8,972.7,31.9,971.2,28.2,971.4z"/>
  </g>
</svg>

        </a>

        <span hidden style="display:none;">NSHipster</span>
      </h1>

      <form role="search">
        <input type="text" id="st-search-input" class="st-search-input" />
      </form>

      
    </header>

    <div id="main" role="main" itemprop="mainContentOfPage">
      

<article role="article" itemscope itemtype="http://schema.org/Article">
  <header role="heading">
    <h1 class="title" itemprop="name">
      <a href="/nsfilemanager/">NSFile​Manager</a>
    </h1>

    <h2>
    
      Written by <a class="author" href="/authors/mattt-thompson/">Mattt Thompson</a> —
    
    <time datetime="2013-11-18T00:00:00-08:00" itemprop="datePublished">November 18<sup>th</sup>, 2013</time>
    
    </h2>

  </header>

  <div class="content" itemprop="articleBody" data-swiftype-index="true">
    <p><code>NSFileManager</code> is Foundation&rsquo;s high-level API for working with file systems. It abstracts Unix and Finder internals, providing a convenient way to create, read, move, copy, and delete files &amp; directories on local or networked drives, as well as iCloud ubiquitous containers.</p>

<p>File systems are a complex topic, with decades of history, vestigial complexities, and idiosyncrasies, and is well outside the scope of a single article. And since most applications don&rsquo;t often interact with the file system much beyond simple file operations, one can get away with only knowing the basics.</p>

<p>What follows are some code samples for your copy-pasting pleasure. Use them as a foundation for understanding how to adjust parameters to your particular use case:</p>

<h2 id="common-tasks">Common Tasks</h2>

<blockquote>
<p>Throughout the code samples is the magical incantation <code>NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES)</code>. This may be tied with KVO as one of the worst APIs in Cocoa. Just know that this returns an array containing the user documents directory as the first object. Thank goodness for the inclusion of <code>NSArray -firstObject</code>.</p>
</blockquote>

<h3 id="determining-if-a-file-exists">Determining If A File Exists</h3>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSFileManager</span> <span class="n">defaultManager</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">documentsPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">)</span> <span class="n">firstObject</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">filePath</span> <span class="o">=</span> <span class="p">[</span><span class="n">documentsPath</span> <span class="nl">stringByAppendingPathComponent</span><span class="p">:</span><span class="s">@&quot;file.txt&quot;</span><span class="p">];</span>
<span class="kt">BOOL</span> <span class="n">fileExists</span> <span class="o">=</span> <span class="p">[</span><span class="n">fileManager</span> <span class="nl">fileExistsAtPath</span><span class="p">:</span><span class="n">filePath</span><span class="p">];</span>
</code></pre></div>
<h3 id="listing-all-files-in-a-directory">Listing All Files In A Directory</h3>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSFileManager</span> <span class="n">defaultManager</span><span class="p">];</span>
<span class="bp">NSURL</span> <span class="o">*</span><span class="n">bundleURL</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSBundle</span> <span class="n">mainBundle</span><span class="p">]</span> <span class="n">bundleURL</span><span class="p">];</span>
<span class="bp">NSArray</span> <span class="o">*</span><span class="n">contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">fileManager</span> <span class="nl">contentsOfDirectoryAtURL</span><span class="p">:</span><span class="n">bundleURL</span>
                               <span class="nl">includingPropertiesForKeys</span><span class="p">:</span><span class="l">@[]</span>
                                                  <span class="nl">options</span><span class="p">:</span><span class="n">NSDirectoryEnumerationSkipsHiddenFiles</span>
                                                    <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>

<span class="bp">NSPredicate</span> <span class="o">*</span><span class="n">predicate</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSPredicate</span> <span class="nl">predicateWithFormat</span><span class="p">:</span><span class="s">@&quot;pathExtension == &#39;png&#39;&quot;</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="n">fileURL</span> <span class="k">in</span> <span class="p">[</span><span class="n">contents</span> <span class="nl">filteredArrayUsingPredicate</span><span class="p">:</span><span class="n">predicate</span><span class="p">])</span> <span class="p">{</span>
    <span class="c1">// Enumerate each .png file in directory</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="recursively-enumerating-files-in-a-directory">Recursively Enumerating Files In A Directory</h2>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSFileManager</span> <span class="n">defaultManager</span><span class="p">];</span>
<span class="bp">NSURL</span> <span class="o">*</span><span class="n">bundleURL</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSBundle</span> <span class="n">mainBundle</span><span class="p">]</span> <span class="n">bundleURL</span><span class="p">];</span>
<span class="bp">NSDirectoryEnumerator</span> <span class="o">*</span><span class="n">enumerator</span> <span class="o">=</span> <span class="p">[</span><span class="n">fileManager</span> <span class="nl">enumeratorAtURL</span><span class="p">:</span><span class="n">bundleURL</span>
                                      <span class="nl">includingPropertiesForKeys</span><span class="p">:</span><span class="l">@[</span><span class="n">NSURLNameKey</span><span class="p">,</span> <span class="n">NSURLIsDirectoryKey</span><span class="l">]</span>
                                                         <span class="nl">options</span><span class="p">:</span><span class="n">NSDirectoryEnumerationSkipsHiddenFiles</span>
                                                    <span class="nl">errorHandler</span><span class="p">:</span><span class="o">^</span><span class="kt">BOOL</span><span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="n">url</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;[Error] %@ (%@)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">url</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">NO</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}];</span>

<span class="bp">NSMutableArray</span> <span class="o">*</span><span class="n">mutableFileURLs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSMutableArray</span> <span class="n">array</span><span class="p">];</span>
<span class="k">for</span> <span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="n">fileURL</span> <span class="k">in</span> <span class="n">enumerator</span><span class="p">)</span> <span class="p">{</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">filename</span><span class="p">;</span>
    <span class="p">[</span><span class="n">fileURL</span> <span class="nl">getResourceValue</span><span class="p">:</span><span class="o">&amp;</span><span class="n">filename</span> <span class="nl">forKey</span><span class="p">:</span><span class="n">NSURLNameKey</span> <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>

    <span class="bp">NSNumber</span> <span class="o">*</span><span class="n">isDirectory</span><span class="p">;</span>
    <span class="p">[</span><span class="n">fileURL</span> <span class="nl">getResourceValue</span><span class="p">:</span><span class="o">&amp;</span><span class="n">isDirectory</span> <span class="nl">forKey</span><span class="p">:</span><span class="n">NSURLIsDirectoryKey</span> <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>

    <span class="c1">// Skip directories with &#39;_&#39; prefix, for example</span>
    <span class="k">if</span> <span class="p">([</span><span class="n">filename</span> <span class="nl">hasPrefix</span><span class="p">:</span><span class="s">@&quot;_&quot;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">[</span><span class="n">isDirectory</span> <span class="n">boolValue</span><span class="p">])</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">enumerator</span> <span class="n">skipDescendants</span><span class="p">];</span>
        <span class="k">continue</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">isDirectory</span> <span class="n">boolValue</span><span class="p">])</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">mutableFileURLs</span> <span class="nl">addObject</span><span class="p">:</span><span class="n">fileURL</span><span class="p">];</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="creating-a-directory">Creating a Directory</h3>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSFileManager</span> <span class="n">defaultManager</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">documentsPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">)</span> <span class="n">firstObject</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">imagesPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">documentsPath</span> <span class="nl">stringByAppendingPathComponent</span><span class="p">:</span><span class="s">@&quot;images&quot;</span><span class="p">];</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">fileManager</span> <span class="nl">fileExistsAtPath</span><span class="p">:</span><span class="n">imagesPath</span><span class="p">])</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">fileManager</span> <span class="nl">createDirectoryAtPath</span><span class="p">:</span><span class="n">imagesPath</span> <span class="nl">withIntermediateDirectories</span><span class="p">:</span><span class="nb">NO</span> <span class="nl">attributes</span><span class="p">:</span><span class="nb">nil</span> <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="deleting-a-file">Deleting a File</h3>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSFileManager</span> <span class="n">defaultManager</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">documentsPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">)</span> <span class="n">firstObject</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">filePath</span> <span class="o">=</span> <span class="p">[</span><span class="n">documentsPath</span> <span class="nl">stringByAppendingPathComponent</span><span class="p">:</span><span class="s">@&quot;image.png&quot;</span><span class="p">];</span>
<span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">[</span><span class="n">fileManager</span> <span class="nl">removeItemAtPath</span><span class="p">:</span><span class="n">filePath</span> <span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">])</span> <span class="p">{</span>
    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;[Error] %@ (%@)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">filePath</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="determining-the-creation-date-of-a-file">Determining the Creation Date of a File</h3>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSFileManager</span> <span class="n">defaultManager</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">documentsPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">)</span> <span class="n">firstObject</span><span class="p">];</span>
<span class="bp">NSString</span> <span class="o">*</span><span class="n">filePath</span> <span class="o">=</span> <span class="p">[</span><span class="n">documentsPath</span> <span class="nl">stringByAppendingPathComponent</span><span class="p">:</span><span class="s">@&quot;Document.pages&quot;</span><span class="p">];</span>

<span class="bp">NSDate</span> <span class="o">*</span><span class="n">creationDate</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
<span class="k">if</span> <span class="p">([</span><span class="n">fileManager</span> <span class="nl">fileExistsAtPath</span><span class="p">:</span><span class="n">filePath</span><span class="p">])</span> <span class="p">{</span>
    <span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">attributes</span> <span class="o">=</span> <span class="p">[</span><span class="n">fileManager</span> <span class="nl">attributesOfItemAtPath</span><span class="p">:</span><span class="n">filePath</span> <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
    <span class="n">creationDate</span> <span class="o">=</span> <span class="n">attributes</span><span class="p">[</span><span class="n">NSFileCreationDate</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<p>There are a number of file attributes that are made accessible through <code>NSFileManager</code>, which can be fetched with <code>-attributesOfItemAtPath:error:</code>, and other methods:</p>

<h4 id="file-attribute-keys">File Attribute Keys</h4>

<blockquote>
<ul>
<li><code>NSFileAppendOnly</code>: The key in a file attribute dictionary whose value indicates whether the file is read-only.</li>
<li><code>NSFileBusy</code>: The key in a file attribute dictionary whose value indicates whether the file is busy.</li>
<li><code>NSFileCreationDate</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s creation date.</li>
<li><code>NSFileOwnerAccountName</code>: The key in a file attribute dictionary whose value indicates the name of the file&rsquo;s owner.</li>
<li><code>NSFileGroupOwnerAccountName</code>: The key in a file attribute dictionary whose value indicates the group name of the file&rsquo;s owner.</li>
<li><code>NSFileDeviceIdentifier</code>: The key in a file attribute dictionary whose value indicates the identifier for the device on which the file resides.</li>
<li><code>NSFileExtensionHidden</code>: The key in a file attribute dictionary whose value indicates whether the file&rsquo;s extension is hidden.</li>
<li><code>NSFileGroupOwnerAccountID</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s group ID.</li>
<li><code>NSFileHFSCreatorCode</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s HFS creator code.</li>
<li><code>NSFileHFSTypeCode</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s HFS type code.</li>
<li><code>NSFileImmutable</code>: The key in a file attribute dictionary whose value indicates whether the file is mutable.</li>
<li><code>NSFileModificationDate</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s last modified date.</li>
<li><code>NSFileOwnerAccountID</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s owner&rsquo;s account ID.</li>
<li><code>NSFilePosixPermissions</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s Posix permissions.</li>
<li><code>NSFileReferenceCount</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s reference count.</li>
<li><code>NSFileSize</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s size in bytes.</li>
<li><code>NSFileSystemFileNumber</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s filesystem file number.</li>
<li><p><code>NSFileType</code>: The key in a file attribute dictionary whose value indicates the file&rsquo;s type.</p></li>
<li><p><code>NSDirectoryEnumerationSkipsSubdirectoryDescendants</code>: Perform a shallow enumeration; do not descend into directories.</p></li>
<li><p><code>NSDirectoryEnumerationSkipsPackageDescendants</code>: Do not descend into packages.</p></li>
<li><p><code>NSDirectoryEnumerationSkipsHiddenFiles</code>: Do not enumerate hidden files.</p></li>
</ul>
</blockquote>

<h2 id="nsfilemanagerdelegate">NSFileManagerDelegate</h2>

<p><code>NSFileManager</code> may optionally set a delegate to verify that it should perform a particular file operation. This allows the business logic of, for instance, which files to protect from deletion, to be factored out of the controller.</p>

<p>There are four kinds of methods in the <code>&lt;NSFileManagerDelegate&gt;</code> protocol, each with a variation for working with paths, as well as methods for error handling:</p>

<ul>
<li><code>-fileManager:shouldMoveItemAtURL:toURL:</code></li>
<li><code>-fileManager:shouldCopyItemAtURL:toURL:</code></li>
<li><code>-fileManager:shouldRemoveItemAtURL:</code></li>
<li><code>-fileManager:shouldLinkItemAtURL:toURL:</code></li>
</ul>

<p>If you were wondering when you might <code>alloc init</code> your own <code>NSFileManager</code> rather than using the shared instance, this is it. As per the documentation:</p>

<blockquote>
<p>If you use a delegate to receive notifications about the status of move, copy, remove, and link operations, you should create a unique instance of the file manager object, assign your delegate to that object, and use that file manager to initiate your operations.</p>
</blockquote>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSFileManager</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
<span class="n">fileManager</span><span class="p">.</span><span class="n">delegate</span> <span class="o">=</span> <span class="n">delegate</span><span class="p">;</span>

<span class="bp">NSURL</span> <span class="o">*</span><span class="n">bundleURL</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSBundle</span> <span class="n">mainBundle</span><span class="p">]</span> <span class="n">bundleURL</span><span class="p">];</span>
<span class="bp">NSArray</span> <span class="o">*</span><span class="n">contents</span> <span class="o">=</span> <span class="p">[</span><span class="n">fileManager</span> <span class="nl">contentsOfDirectoryAtURL</span><span class="p">:</span><span class="n">bundleURL</span>
                               <span class="nl">includingPropertiesForKeys</span><span class="p">:</span><span class="l">@[]</span>
                                                  <span class="nl">options</span><span class="p">:</span><span class="n">NSDirectoryEnumerationSkipsHiddenFiles</span>
                                                    <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>

<span class="k">for</span> <span class="p">(</span><span class="bp">NSString</span> <span class="o">*</span><span class="n">filePath</span> <span class="k">in</span> <span class="n">contents</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">[</span><span class="n">fileManager</span> <span class="nl">removeItemAtPath</span><span class="p">:</span><span class="n">filePath</span> <span class="nl">error</span><span class="p">:</span><span class="nb">nil</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="customfilemanagerdelegate.m">CustomFileManagerDelegate.m</h4>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="cp">#pragma mark - NSFileManagerDelegate</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">fileManager:</span><span class="p">(</span><span class="bp">NSFileManager</span> <span class="o">*</span><span class="p">)</span><span class="nv">fileManager</span>
<span class="nf">shouldRemoveItemAtURL:</span><span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nv">URL</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="o">!</span><span class="p">[[[</span><span class="n">URL</span> <span class="n">lastPathComponent</span><span class="p">]</span> <span class="n">pathExtension</span><span class="p">]</span> <span class="nl">isEqualToString</span><span class="p">:</span><span class="s">@&quot;pdf&quot;</span><span class="p">];</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="ubiquitous-storage">Ubiquitous Storage</h2>

<p>Documents can also be moved to iCloud. If you guessed that this would be anything but straight forward, you&rsquo;d be 100% correct.</p>

<p>This is another occasion when you&rsquo;d <code>alloc init</code> your own <code>NSFileManager</code> rather than using the shared instance. Because <code>URLForUbiquityContainerIdentifier:</code> and <code>setUbiquitous:itemAtURL:destinationURL:error:</code> are blocking calls, this entire operation needs to be dispatched to a background queue.</p>

<h3 id="moving-an-item-to-ubiquitous-storage">Moving an Item to Ubiquitous Storage</h3>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="n">dispatch_async</span><span class="p">(</span><span class="n">dispatch_get_global_queue</span><span class="p">(</span><span class="n">DISPATCH_QUEUE_PRIORITY_BACKGROUND</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">^</span><span class="p">{</span>
    <span class="bp">NSFileManager</span> <span class="o">*</span><span class="n">fileManager</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSFileManager</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">documentsPath</span> <span class="o">=</span> <span class="p">[</span><span class="n">NSSearchPathForDirectoriesInDomains</span><span class="p">(</span><span class="n">NSDocumentDirectory</span><span class="p">,</span> <span class="n">NSUserDomainMask</span><span class="p">,</span> <span class="nb">YES</span><span class="p">)</span> <span class="n">firstObject</span><span class="p">];</span>
    <span class="bp">NSURL</span> <span class="o">*</span><span class="n">fileURL</span> <span class="o">=</span> <span class="p">[</span><span class="bp">NSURL</span> <span class="nl">fileURLWithPath</span><span class="p">:[</span><span class="n">documentsPath</span> <span class="nl">stringByAppendingPathComponent</span><span class="p">:</span><span class="s">@&quot;Document.pages&quot;</span><span class="p">]];</span>

    <span class="c1">// Defaults to first listed in entitlements when `nil`; should replace with real identifier</span>
    <span class="bp">NSString</span> <span class="o">*</span><span class="n">identifier</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>

    <span class="bp">NSURL</span> <span class="o">*</span><span class="n">ubiquitousContainerURL</span> <span class="o">=</span> <span class="p">[</span><span class="n">fileManager</span> <span class="nl">URLForUbiquityContainerIdentifier</span><span class="p">:</span><span class="n">identifier</span><span class="p">];</span>
    <span class="bp">NSURL</span> <span class="o">*</span><span class="n">ubiquitousFileURL</span> <span class="o">=</span> <span class="p">[</span><span class="n">ubiquitousContainerURL</span> <span class="nl">URLByAppendingPathComponent</span><span class="p">:</span><span class="s">@&quot;Document.pages&quot;</span><span class="p">];</span>

    <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span> <span class="o">=</span> <span class="nb">nil</span><span class="p">;</span>
    <span class="kt">BOOL</span> <span class="n">success</span> <span class="o">=</span> <span class="p">[</span><span class="n">fileManager</span> <span class="nl">setUbiquitous</span><span class="p">:</span><span class="nb">YES</span>
                                    <span class="nl">itemAtURL</span><span class="p">:</span><span class="n">fileURL</span>
                               <span class="nl">destinationURL</span><span class="p">:</span><span class="n">ubiquitousFileURL</span>
                                        <span class="nl">error</span><span class="p">:</span><span class="o">&amp;</span><span class="n">error</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">success</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;[Error] %@ (%@) (%@)&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">fileURL</span><span class="p">,</span> <span class="n">ubiquitousFileURL</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<blockquote>
<p>You can find more information about ubiquitous document storage in Apple&rsquo;s &ldquo;iCloud File Management&rdquo; document.</p>
</blockquote>

<hr>

<p>There&rsquo;s a lot to know about file systems, but as an app developer, it&rsquo;s mostly an academic exercise. Now don&rsquo;t get me wrong—academic exercises are great! But they don&rsquo;t ship code. <code>NSFileManager</code> allows you to ignore most of the subtlety of all of this and get things done.</p>

  </div>

  <footer role="complementary">
    
    <section id="revisions">
      <small>NSMutableHipster</small>

      <p>
      Questions? Corrections?  <a href="https://github.com/NSHipster/articles/issues">Issues</a> and <a href="https://github.com/NSHipster/articles/blob/master/2013-11-18-nsfilemanager.md">pull requests</a> are always welcome — NSHipster is made better by readers like you.
      </p>
      
      <p>
      
            
      
      Find status information for all articles on the <a href="/status/">status page</a>.
      </p>
      
      <dl>
      
      </dl>
    </section>
    

    <section id="follow">
      <small>Follow NSHipster</small>

      <ul>
        <li class="twitter">
          <a href="https://twitter.com/intent/user?screen_name=NSHipster" title="Follow NSHipster on Twitter"><i class="icon-twitter" aria-hidden="true"></i></a>
        </li>
        <li class="facebook">
          <a href="https://www.facebook.com/NSHipster" title="Like NSHipster on Facebook"><i class="icon-facebook" aria-hidden="true"></i></a>
        </li>
        <li class="google-plus">
          <a href="https://plus.google.com/+NSHipster" title="Follow NSHipster on G+"><i class="icon-googleplus" aria-hidden="true"></i></a>
        </li>
        <li class="rss">
          <a href="/feed.xml" title="Subscribe to the NSHipster RSS Feed"><i class="icon-feed" aria-hidden="true"></i></a>
        </li>
      </ul>

      <form action="https://tinyletter.com/NSHipster" method="post" target="popupwindow" onsubmit="window.open('https://tinyletter.com/NSHipster', 'popupwindow', 'scrollbars=yes,width=800,height=600');return true">
        <label for="tlemail" hidden style="display:none;">Enter Your Email Address</label>
        <input type="email" name="email" id="tlemail" placeholder="Your Email Address"/>
        <input type="hidden" name="embed" value="1"/>
        <input type="submit" value="Join the Newsletter"/>
      </form>
    </section>

    <section id="attribution">
      
  <div class="contributor" itemprop="author" itemscope itemtype="http://data-vocabulary.org/Person">
    <small>Written by</small>

    <img class="avatar" alt="Mattt Thompson" itemprop="image" src="http://nshipster.s3.amazonaws.com/mattt-thompson.jpg" draggable="false"/>
    <div class="details">
      <span itemprop="name"><a href="/authors/mattt-thompson/">Mattt Thompson</a></span>

      <p><a href="https://github.com/mattt">Mattt Thompson</a> (<a href="https://twitter.com/mattt">@mattt</a>) is a writer and developer from the Rustbelt.</p>


      
        <a href="https://plus.google.com/106751358503565042647?rel=author" rel="author"></a>
      
    </div>
  </div>


    </section>

    

    

    <section>
      <div id="continue">
        <small>Next Article</small>
        
        

          <article>
            <h1 class="title">
              <a href="/nsnotification-and-nsnotificationcenter/" title="NSNotification &<br/>NSNotificationCenter" rel="next">NSNotification &<br/>NSNotification​Center</a>
            </h1>

            <p>Any idea is inextricably linked to how its communicated. A medium defines the form and scale of significance in such a way to shape the very meaning of an idea. Very truly, the medium is the message.</p>

          </article>
      </div>

      
      
        
        
      

      <div id="related">
        <small>Related Articles</small>

        <ul>
          
          
          
            <li>
              <a href="/nsvaluetransformer/" title="NSValueTransformer">NSValueTransformer</a>
            </li>
            
          
          
            <li>
              <a href="/nsvalue/" title="NSValue">NSValue</a>
            </li>
            
          
          
            <li>
              <a href="/multipeer-connectivity/" title="Multipeer Connectivity">Multipeer Connectivity</a>
            </li>
            
          
          
            <li>
              <a href="/nssecurecoding/" title="NSSecureCoding">NSSecureCoding</a>
            </li>
            
          
        </ul>
      </div>
    </section>
  </footer>
</article>

    </div>

    <footer role="contentinfo">
      <section class="credits colophon">
        <p>
          Questions? Corrections? <a href="https://twitter.com/NSHipster">@NSHipster</a> or <a href="https://github.com/NSHipster/articles">on GitHub</a>.
        </p>
        <p>
          <i aria-hidden="true" class="icon-cc"></i>
          <i aria-hidden="true" class="icon-cc-by"></i>
          <i aria-hidden="true" class="icon-cc-nc"></i>
          NSHipster.com is released under a <a href="http://creativecommons.org/licenses/by-nc/4.0/" rel="license">Creative Commons BY-NC License</a>.
        </p>
        <p><abbr title="International Standard Serial Number">ISSN</abbr> 2373-9800</p>
        <p lang="zh-Hans"><a href="http://nshipster.cn" hreflang="zh-Hans" title="Articles also available in Chinese">文章也可在中文版阅读</a>。</p>
        <a href="https://plus.google.com/105091289906267717942" rel="publisher"></a>
      </section>
    </footer>
  </div>

  <script>
    if (window.navigator && window.navigator.loadPurpose === "preview") {
      window.location.href = "http://nshipster.com/topsites_preview.html";
    }
  </script>

  <script async>
    var Swiftype = window.Swiftype || {};
    (function() {
      Swiftype.key = 'Q5jNBiR8qVs5xE5dNect';
      var script = document.createElement('script');
      script.type = 'text/javascript';
      script.async = true;
      script.src = "//swiftype.com/embed.js";
      var entry = document.getElementsByTagName('script')[0];
      document.getElementsByTagName('script')[0].parentNode.insertBefore(script, entry);
    }());
  </script>

  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-49868484-1', 'nshipster.com');
    ga('send', 'pageview');
  </script>

</body>
</html>
